<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8' />
        <title></title>
        <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
        <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.js'></script>
        <link rel="stylesheet" type="text/css" href="mapTest.css">
        <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.css' rel='stylesheet' />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.1.3/css/jasny-bootstrap.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300">
        <link rel="stylesheet" href="https://cdn.rawgit.com/yahoo/pure-release/v0.6.0/pure-min.css">
        <link rel="stylesheet" href="auto-complete.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="auto-complete.js"></script>
        <script src="mapScripts.js"></script>
        <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" async defer></script>
    </head>


    <body>
        <nav id="navbar-white" class="navbar navbar-default navbar-fixed-top" style="width: 0%" role="navigation">
    <div class="navbar-header">
      <button href="#menu-toggle" class="slidebar-toggle" id="menu-toggle">
        <span class="sr-only">Toggle sidebar</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
  <!--    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button> -->
    </div>
  </nav>



  <div id="wrapper" class="toggled">
        <!-- Sidebar -->
	<div id="slidebar-white" class="slidebar-nav">
      <nav id="navbar-white" class="navbar navbar-default" role="navigation">
        <ul class="nav navbar-nav">
          <li class="hidden-xs"><a class="navbar-brand" href="/">Slidebar</a></li>
          <li class="sidebar-form">
            <form class="input-group" border="0" id="af" name="af" role="search" action="/archive.php">
                <input type="text" class="form-control" id="aa" name="aa" placeholder="Search">
              <span class="input-group-btn">
                <button type="submit" class="btn btn-md" id="as" name="as" value="Go"><i class="glyphicon glyphicon-search"></i></button>
              </span>
            </form>
          </li>
          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-th-list"></i> Services <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/">Carwashes</a></li>
            <li><a href="/">Lapdances</a></li>
            <li><a href="/">Musicals</a></li>
            <li><a href="/">Tutorials</a></li>
            <li><a href="/">Catering</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-tags"></i> Products <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/">Books</a></li>
            <li><a href="/">Leaflets</a></li>
            <li><a href="/">CDs</a></li>
            <li class="divider"></li>
            <li class="dropdown-header">Merchandise</li>
            <li><a href="/">Towels</a></li>
            <li><a href="/">Flags</a></li>
            <li><a href="/">Coffee Mugs</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i> Profile <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/"><i class="glyphicon glyphicon-user"></i> Profile</a></li>
            <li><a href="/"><i class="glyphicon glyphicon-plus"></i> Account</a></li>
            <li><a href="/"><i class="glyphicon glyphicon-cog"></i> Settings</a></li>
            <li><a href="/"><i class="glyphicon glyphicon-comment"></i> Notifications</a></li>
          </ul>
        </li>
        </ul>
      </nav><!--/.navbar -->
    </div><!--/.sidebar-nav -->


    <!-- Page Content -->
   <!-- <main id="page-wrapper6"> -->
      <div class="container-fluid" style="height: 100%">
          
          <!-- Search bar -->
              <div class="input-group col-md-3 col-md-offset-4 floatburger front" style="width: 25%">
                  <input type="text" class="form-control pure-form input-lg" id="advanced-demo" placeholder="search" />
                  <span class="input-group-btn">
                      <button id="mainSearchBtn" class="btn btn-lg" type="button" onclick="searchBtn()">
                          <i class="glyphicon glyphicon-search"></i>
                      </button>
                  </span>
              </div>
          <!-- /Search bar -->
          
          <div id='map'></div>

          <script>
              mapboxgl.accessToken = 'pk.eyJ1Ijoic2Vwcm90aHgiLCJhIjoiY2l5Nm55eHFnMDAwMzJ3bXhhYWZiYnpkeCJ9.ahH9UF5cEeZPs32GTdFzCg';
              var map = new mapboxgl.Map({
                  container: 'map', // container id
                  style: 'mapbox://styles/seprothx/ciyl5737l003n2smgmzlic9xq', //stylesheet location
                  center: [-122.28476, 37.5173774], // starting position
                  zoom: 17.5 // starting zoom
              });

              map.on('click', function(e) {
                  var features = map.queryRenderedFeatures(e.point, {
                      layers: ['ndnux'] // replace this with the name of the layer
                  });

                  if (!features.length) {
                      return;
                  }
                  
                  map.flyTo({
                        center: features[0].geometry.coordinates,
                        speed: 0.3
                  });

                  var feature = features[0];

                  var popup = new mapboxgl.Popup({ offset: [0, -15] })
                  .setLngLat(feature.geometry.coordinates)
                  .setHTML('<h3>' + feature.properties.title + '</h3><p>' + feature.properties.description + '</p>')
                  .setLngLat(feature.geometry.coordinates)
                  .addTo(map);
              });
              
              function searchBtn(){
                   //this function authored by JohnPhilip Lahman
                  var x = document.getElementById('advanced-demo').value;
                  if(x == "St. Mary's Hall"){
                      map.flyTo({
                          center: [-122.2849, 37.51675],
                          speed: 0.3,
                          //zoom: 20
                      });
                      
                      var popup = new mapboxgl.Popup({closeOnClick: true})
                      .setLngLat([-122.2849, 37.51675])
                      .setHTML('<h3>St.Mary\'s hall</h3><p>Saint Mary’s hall houses the majority of classrooms. Newly remodeled, the science and computer labs are located in this building along with public safety, financial aid, the registrar, and the business office.</p>')
                      .addTo(map);
                      
                  } else if(x == "The Carl and Celia Berta Gellert Library"){
                      map.flyTo({
                          center: [-122.284719, 37.51755],
                          speed: 0.3,
                          //zoom: 20
                      });
                      
                      var popup = new mapboxgl.Popup({closeOnClick: true})
                      .setLngLat([-122.284719, 37.51755])
                      .setHTML('<h3>Carl and Celia Berta Gellert Library</h3><p>The library offers a place to study and access to books, periodicals, journals, and online databases. Reference librarians are available to assist with research and other needs</p>')
                      .addTo(map);
                      
                  }else if(x == "Ralston Hall"){
                      map.flyTo({
                          center: [-122.286784, 37.517380],
                          speed: 0.3,
                          //zoom: 20
                      });
                      
                      var popup = new mapboxgl.Popup({closeOnClick: true})
                      .setLngLat([-122.286784, 37.517380])
                      .setHTML('<h3>Ralston Hall Mansion</h3><p>In 1966, the U.S. Department of the Interior designated Ralston Hall a National Historic Landmark, it is also a designated California Historic Landmark. The mansion is currently undergoing a massive renovation and is currently closed.</p>')
                      .addTo(map);
                      
                  }
                  
              }
              
              $("#advanced-demo").keyup(function(event){
                if(event.keyCode == 13){
                    $("#mainSearchBtn").click();
                }
              });
             /* document.getElementById('mainSearchBtn').addEventListener('click', function() {
                  //this function authored by JohnPhilip Lahman
                  var x = document.getElementById('advanced-demo').value;
                  if(x == "St. Mary's Hall"){
                      map.flyTo({
                          center: [-122.2849, 37.51675],
                          speed: 0.3,
                          //zoom: 20
                      });
                      
                      var popup = new mapboxgl.Popup({closeOnClick: true})
                      .setLngLat([-122.2849, 37.51675])
                      .setHTML('<h3>St.Mary\'s hall</h3><p>Saint Mary’s hall houses the majority of classrooms. Newly remodeled, the science and computer labs are located in this building along with public safety, financial aid, the registrar, and the business office.</p>')
                      .addTo(map);
                      
                  }
              });*/
          </script>
        </div>
   <!-- </main> -->
  </div><!-- /#wrapper -->


  <!-- The Modal -->
<div id="welcomeModal" class="modal2">

  <!-- Modal content -->
  <div class="modal-content2">
    
    <div class="modal-header2">
      <span class="close2">&times;</span>
      <img src="http://i.imgur.com/A35ss2e.png" alt="argo">
  </div>

    <div class="modal-body2">
      <p>Welcome to the NDNU Campus Tour!</p>
      <p1>This is an interactive map.</p1>
      <p2>Take a look around or search for campus locations in the search bar.</p2>
    </div>
    <div class="modal-footer2">
    </div>
  </div>

</div>

    </body>
    <script>
        $("#menu-toggle").click(function(e){e.preventDefault();$("#wrapper").toggleClass("toggled");});

        var locationSearch = new autoComplete({
            selector: '#advanced-demo',
            minChars: 0,
            source: function(term, suggest){
                term = term.toLowerCase();
                var choices = [['St. Mary\'s Hall'], ['Financial Aid'], ['Registrar'], ['Business Office'], ['Public Safety'], ['Cafeteria'], ['The Carl and Celia Berta Gellert Library'], ['Library Lawn'], ['Walter Gleason Gym'], ['Campus Center'], ['Academic Success Center'], ['Admissions'], ['International Student Office'], ['Student Life & Leadership Office'], ['The Quad'], ['Writing Center'], ['Cunningham Chapel Annex'], ['Center for Spirituality'], ['Office of Diversity'], ['Dorothy Stang Center'], ['Julie Billiart Hall'], ['Dean of Students/Student Affairs'], ['Career Services'], ['St. Joseph Hall'], ['Housing'], ['The Apartments'], ['Koret Athletic Field'], ['Toso Residence (Compiegne)'], ['Human Resources'], ['Administration'], ['New Hall'], ['Counseling and Health Services'], ['Taube Center'], ['Ralston Hall'], ['Weigand Gallery'], ['Madison Art Center'], ['Cuvilly Hall'], ['Tabard'], ['Bookstore'], ['Gavin Hall'],['Province Center']];
                var suggestions = [];
                for (i=0;i<choices.length;i++)
                    if (~(choices[i][0]+' '+choices[i][1]).toLowerCase().indexOf(term)) suggestions.push(choices[i]);
                suggest(suggestions);
            },
            renderItem: function (item, search){
                search = search.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&amp;');
                var re = new RegExp("(" + search.split(' ').join('|') + ")", "gi");
                return '<div class="autocomplete-suggestion" data-langname="'+item[0]+'" data-lang="'+item[1]+'" data-val="'+search+'">'+item[0].replace(re, "<b>$1</b>")+'</div>';
            },
            onSelect: function(e, term, item){
                console.log('Item "'+item.getAttribute('data-langname')+' ('+item.getAttribute('data-lang')+')" selected by '+(e.type == 'keydown' ? 'pressing enter' : 'mouse click')+'.');
                document.getElementById('advanced-demo').value = item.getAttribute('data-langname');
            }
        });

        if (~window.location.href.indexOf('http')) {
            (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
            (function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s); js.id = id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4&appId=114593902037957";fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
            document.getElementById('github_social').innerHTML = '\
                <iframe style="float:left;margin-right:15px" src="//ghbtns.com/github-btn.html?user=Pixabay&repo=JavaScript-autoComplete&type=watch&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>\
                <iframe style="float:left;margin-right:15px" src="//ghbtns.com/github-btn.html?user=Pixabay&repo=JavaScript-autoComplete&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>\
            ';
        }

    // Get the modal
    var modal2 = document.getElementById('welcomeModal');

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close2")[0];

    // Modal opens on page load
    function welcomeModal() {
        modal2.style.display = "block";
    }
    window.onload =welcomeModal;

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal2.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal2) {
            modal2.style.display = "none";
        }
    }

    </script>
</html>
